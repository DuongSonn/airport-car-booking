(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[24],{1093:function(t,e,n){"use strict";n.r(e);var c=n(825),a=n(21),r=n(773),s=n(1),o=n(738),i=n(820),u=n(829),d=n(720),f=n(828),j=n(22),b=n(809),p=n(185),O=n(769),l=n.n(O),h=n(186),E=n(184),m=n(868),x=n(17);e.default=Object(E.b)()((function(t){var e=t.t,n=Object(s.useState)({current:1,pageSize:100}),O=Object(r.a)(n,2),E=O[0],q=O[1],g=Object(s.useState)(),y=Object(r.a)(g,2),S=y[0],_=y[1],v=Object(s.useState)([]),C=Object(r.a)(v,2),T=C[0],I=C[1],N=Object(s.useState)([]),R=Object(r.a)(N,2),A=R[0],k=R[1],D=Object(s.useState)([]),U=Object(r.a)(D,2),F=U[0],L=U[1],Q=Object(h.c)((function(t){return t.provinces})),P=Object(h.c)((function(t){return t.carTypes})),Y=Object(h.c)((function(t){return t.user})),z=[{title:e("ID"),dataIndex:"key"},{title:e("Pickup Location"),dataIndex:"request_destinations",render:function(t){return Object(x.jsx)(x.Fragment,{children:t.map((function(t){return t.type===j.f.PICKUP_LOCATION&&t.location[0]}))})}},{title:e("Drop Off Location"),dataIndex:"request_destinations",render:function(t){return Object(x.jsx)(x.Fragment,{children:t.map((function(t){return t.type===j.f.DROP_OFF_LOCATION&&t.location[0]}))})}},{title:e("Province"),dataIndex:"province",render:function(t){return Object(x.jsx)(x.Fragment,{children:t.name})},filters:T},{title:e("Pickup Time"),dataIndex:"pickup_at",render:function(t){return Object(x.jsx)(x.Fragment,{children:l()(parseInt(t)).format("HH:mm DD-MM-YYYY")})}},{title:e("Price"),dataIndex:"price",render:function(t,e){var n;return Y.data.role===j.d.AGENCY?e.discount?(n=t-t/100*e.discount,n=1e3*Math.round(n/1e3)):n=t:Y.data.role===j.d.HOST&&(n=e.base_price),Object(x.jsx)(x.Fragment,{children:n.toLocaleString("it-IT",{style:"currency",currency:"VND"})})}},{title:e("Car Type"),dataIndex:"car_type",render:function(t){return Object(x.jsxs)(x.Fragment,{children:[t.type," Seats"]})},filters:A},{title:e("Status"),dataIndex:"status",render:function(t){var e,n;return t===j.e.REQUEST_NEW.id?(e="green",n=j.e.REQUEST_NEW.name):t===j.e.REQUEST_CANCELED.id&&(e="volcano",n=j.e.REQUEST_CANCELED.name),Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(i.a,{color:e,children:n.toUpperCase()},n)})},filters:F},{title:e("Action"),dataIndex:"_id",render:function(t){return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(u.b,{size:"middle",children:Object(x.jsx)(p.b,{to:"/requests/".concat(t),children:e("Detail")})})})}}];return Object(s.useEffect)((function(){Y.data.role===j.d.AGENCY?(Q.forEach((function(t){I((function(e){return[].concat(Object(c.a)(e),[{text:t.name,value:t._id}])}))})),P.forEach((function(t){k((function(e){return[].concat(Object(c.a)(e),[{text:"".concat(t.type," Seats"),value:t._id}])}))})),L([{text:j.e.REQUEST_NEW.name,value:j.e.REQUEST_NEW.id},{text:j.e.REQUEST_CANCELED.name,value:j.e.REQUEST_CANCELED.id}]),m.a.getInstance(Y.data._id,Y.data.role).on("notification",(function(t){t.type&&t.type==j.c.CONTRACT&&Object(b.d)(E,{},{},(function(t){if(t.requests){var e=1;t.requests.forEach((function(t){t.key=e++})),_(t.requests),q(Object(a.a)(Object(a.a)({},E),{},{total:t.total}))}}))}))):Y.data.role===j.d.HOST&&m.a.getInstance(Y.data._id,Y.data.role).on("notification",(function(t){t.type&&t.type==j.c.REQUEST&&Object(b.d)(E,{},{},(function(t){if(t.requests){var e=1;t.requests.forEach((function(t){t.key=e++})),_(t.requests),q(Object(a.a)(Object(a.a)({},E),{},{total:t.total}))}}))})),Object(b.d)(E,{},{},(function(t){if(t.requests){var e=1;t.requests.forEach((function(t){t.key=e++})),_(t.requests),q(Object(a.a)(Object(a.a)({},E),{},{total:t.total}))}}))}),[]),Object(x.jsx)(o.G,{children:Object(x.jsx)(o.j,{xs:"12",md:"12",className:"mb-4",children:Object(x.jsxs)(o.f,{children:[Object(x.jsx)(o.i,{children:e("List Requests")}),Object(x.jsxs)(o.g,{children:[Y.data.role===j.d.AGENCY?Object(x.jsx)(p.b,{to:"/requests/create",children:Object(x.jsx)(d.a,{type:"primary",style:{marginBottom:16},children:e("Create A New Request")})}):null,Object(x.jsx)(f.a,{columns:z,dataSource:S,pagination:E,onChange:function(t,e,n){var c=t.pageSize*(t.current-1)+1;Object(b.d)(t,e,n,(function(e){e.requests&&(e.requests.forEach((function(t){t.key=c++})),_(e.requests),q(Object(a.a)(Object(a.a)({},t),{},{current:t.current,total:e.total})))}))}})]})]})})})}))},809:function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return i})),n.d(e,"f",(function(){return u})),n.d(e,"b",(function(){return d})),n.d(e,"g",(function(){return f}));var c=n(22),a=n(748);function r(t,e,n,s){var o=Object(c.b)(),i="/requests?page=".concat(t.current,"&limit=").concat(t.pageSize,"&provinces=").concat(e.province,"&car_types=").concat(e.car_type,"&status=").concat(e.status);o.get(i).then((function(t){s(t.data)})).catch((function(c){c.response&&(403===c.response.status?Object(a.c)(r(t,e,n,s)):s(c.response.data))}))}function s(t,e){Object(c.b)().post("/requests",t).then((function(t){e(t.data)})).catch((function(n){n.response&&(403===n.response.status||401===n.response.status?Object(a.c)(s(t,e)):e(n.response.data))}))}function o(t,e){Object(c.b)().post("/requests/calculate-price",t).then((function(t){e(t.data)})).catch((function(n){n.response&&(403===n.response.status||401===n.response.status?Object(a.c)(o(t,e)):e(n.response.data))}))}function i(t,e){Object(c.b)().get("/requests/".concat(t)).then((function(t){e(t.data)})).catch((function(n){n.response&&(403===n.response.status||401===n.response.status?Object(a.c)(i(t,e)):e(n.response.data))}))}function u(t,e){Object(c.b)().get("/requests/check?code=".concat(t)).then((function(t){e(t.data)})).catch((function(t){t.response&&e(t.response.data)}))}function d(t,e){Object(c.b)().delete("/requests/".concat(t)).then((function(t){e(t.data)})).catch((function(n){n.response&&(403===n.response.status||401===n.response.status?Object(a.c)(d(t,e)):e(n.response.data))}))}function f(t,e){Object(c.b)().put("/requests/".concat(t.id),t).then((function(t){e(t.data)})).catch((function(n){n.response&&(403===n.response.status?Object(a.c)(f(t,e)):e(n.response.data))}))}}}]);
//# sourceMappingURL=24.cf7dba43.chunk.js.map
(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[23],{1103:function(e,n,t){"use strict";t.r(n);var a=t(1),s=t.n(a),c=t(21),r=t(20),o=t(738),i=t(17),l=Object(i.jsx)("div",{className:"pt-3 text-center",children:Object(i.jsx)("div",{className:"sk-spinner sk-spinner-pulse"})}),d=function(e){return Object(i.jsx)("main",{className:"c-main",children:Object(i.jsx)(o.l,{fluid:!0,children:Object(i.jsx)(a.Suspense,{fallback:l,children:Object(i.jsxs)(r.d,{children:[e.routes.map((function(e,n){return e.component&&Object(i.jsx)(r.b,{path:e.path,exact:e.exact,name:e.name,render:function(n){return Object(i.jsx)(o.r,{children:Object(i.jsx)(e.component,Object(c.a)({},n))})}},n)})),Object(i.jsx)(r.a,{to:"/404"})]})})})})},u=s.a.memo(d),m=function(){return Object(i.jsxs)(o.s,{fixed:!1,children:[Object(i.jsxs)("div",{children:[Object(i.jsx)("a",{href:"https://coreui.io",target:"_blank",rel:"noopener noreferrer",children:"CoreUI"}),Object(i.jsx)("span",{className:"ml-1",children:"\xa9 2020 creativeLabs."})]}),Object(i.jsxs)("div",{className:"mfs-auto",children:[Object(i.jsx)("span",{className:"mr-1",children:"Powered by"}),Object(i.jsx)("a",{href:"https://coreui.io/react",target:"_blank",rel:"noopener noreferrer",children:"CoreUI for React"})]})]})},b=s.a.memo(m),p=t(186),h=t(751),j=t(22),f=s.a.lazy((function(){return t.e(26).then(t.bind(null,1092))})),O=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(3),t.e(18),t.e(24)]).then(t.bind(null,1093))})),v=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(17)]).then(t.bind(null,1094))})),x=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(15)]).then(t.bind(null,1106))})),g=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(14)]).then(t.bind(null,1095))})),N=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(20)]).then(t.bind(null,1096))})),_=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(12)]).then(t.bind(null,1097))})),S=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(11)]).then(t.bind(null,1102))})),C=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(13)]).then(t.bind(null,1098))})),I=s.a.lazy((function(){return Promise.all([t.e(0),t.e(2),t.e(22),t.e(25)]).then(t.bind(null,1099))})),y=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(8)]).then(t.bind(null,1100))})),w=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(9)]).then(t.bind(null,1101))})),k=[{path:"/",exact:!0,component:f,name:"Home"},{path:"/dashboard",name:"Dashboard",component:f,permission:[j.d.ADMIN,j.d.AGENCY,j.d.HOST]},{path:"/requests",name:"Requests",component:O,permission:[j.d.AGENCY,j.d.HOST],exact:!0},{path:"/requests/create",name:"Create Request",component:v,permission:[j.d.AGENCY],exact:!0},{path:"/requests/:id",name:"Request Detail",component:x,permission:[j.d.AGENCY,j.d.HOST],exact:!0},{path:"/contracts",name:"Contracts",component:g,permission:[j.d.AGENCY,j.d.HOST],exact:!0},{path:"/contracts/:id",name:"Contract Detail",component:N,permission:[j.d.AGENCY,j.d.HOST],exact:!0},{path:"/cars",name:"Cars",component:_,permission:[j.d.HOST],exact:!0},{path:"/drivers",name:"Drivers",component:S,permission:[j.d.HOST],exact:!0},{path:"/host-details",name:"Host Details",component:C,permission:[j.d.HOST],exact:!0},{path:"/profile",name:"Profile",component:I,permission:[j.d.AGENCY,j.d.HOST],exact:!0},{path:"/transactions/requests",name:"Requests' Transaction",component:y,permission:[j.d.ADMIN],exact:!0},{path:"/transactions/drivers",name:"Drivers' Transaction",component:w,permission:[j.d.ADMIN],exact:!0}],A=function(){var e=Object(p.b)(),n=Object(p.c)((function(e){return e.changeState.sidebarShow}));return Object(i.jsxs)(o.t,{withSubheader:!0,children:[Object(i.jsx)(o.Q,{inHeader:!0,className:"ml-md-3 d-lg-none",onClick:function(){var t=!![!1,"responsive"].includes(n)||"responsive";e({type:"set",sidebarShow:t})}}),Object(i.jsx)(o.Q,{inHeader:!0,className:"ml-3 d-md-down-none",onClick:function(){var t=![!0,"responsive"].includes(n)&&"responsive";e({type:"set",sidebarShow:t})}}),Object(i.jsx)(o.u,{className:"mx-auto d-lg-none",to:"/",children:Object(i.jsx)(h.a,{name:"logo",height:"48",alt:"Logo"})}),Object(i.jsx)(o.v,{className:"d-md-down-none mr-auto",children:Object(i.jsx)(o.w,{className:"px-3",children:Object(i.jsx)(o.x,{to:"/dashboard",children:"Dashboard"})})}),Object(i.jsxs)(o.v,{className:"px-3",children:[Object(i.jsx)(D,{}),Object(i.jsx)(T,{})]}),Object(i.jsx)(o.P,{className:"px-3 justify-content-between",children:Object(i.jsx)(o.d,{className:"border-0 c-subheader-nav m-0 px-0 px-md-3",routes:k})})]})},H=t(184),E=t(860),T=Object(H.b)()((function(e){var n=e.t,t=Object(p.c)((function(e){return e.user})),a=Object(r.g)(),s=Object(p.b)();return Object(i.jsxs)(o.n,{inNav:!0,className:"c-header-nav-items mx-2",direction:"down",children:[Object(i.jsx)(o.q,{className:"c-header-nav-link",caret:!1,children:Object(i.jsx)("div",{className:"c-avatar",children:Object(i.jsx)(o.y,{src:"avatars/".concat(t.data.avatar),className:"c-avatar-img"})})}),Object(i.jsxs)(o.p,{className:"pt-0",placement:"bottom-end",children:[Object(i.jsxs)(o.o,{to:"/profile",children:[Object(i.jsx)(h.a,{name:"cil-user",className:"mfe-2"})," ",n("Profile")]}),Object(i.jsx)(o.o,{divider:!0}),Object(i.jsxs)(o.o,{onClick:function(){return function(){var e=Object(E.c)();s(e),a.push("/login")}()},children:[Object(i.jsx)(h.a,{name:"cil-account-logout",className:"mfe-2"}),n("Logout")]})]})]})})),G=t(418),D=Object(H.b)()((function(e){var n=e.t,t=Object(p.b)(),a=Object(p.c)((function(e){return e.user})),s=function(e){t(Object(E.a)(e));var n=window.localStorage.getItem("".concat("ddsb","_user"));(n=JSON.parse(n)).language=e,window.localStorage.setItem("".concat("ddsb","_user"),JSON.stringify(n)),G.a.changeLanguage(e)};return Object(i.jsxs)(o.n,{inNav:!0,className:"c-header-nav-item mx-2",direction:"down",children:[Object(i.jsx)(o.q,{className:"c-header-nav-link",caret:!1,children:a&&"vi"===a.data.language?Object(i.jsx)(h.a,{name:"cif-vn"}):a&&"en"===a.data.language?Object(i.jsx)(h.a,{name:"cif-us"}):null}),Object(i.jsxs)(o.p,{className:"pt-0",placement:"bottom-end",children:[Object(i.jsx)(o.o,{onClick:function(){return s("vi")},children:Object(i.jsxs)("div",{children:[Object(i.jsx)(h.a,{name:"cif-vn"})," \xa0 ",n("Vietnamese")]})}),Object(i.jsx)(o.o,{onClick:function(){return s("en")},children:Object(i.jsxs)("div",{children:[Object(i.jsx)(h.a,{name:"cif-us"})," \xa0 ",n("English")]})})]})]})})),q=function(e){for(var n=e.navigation,t=e.t,a=(e.tReady,Object(p.b)()),s=Object(p.c)((function(e){return e.changeState.sidebarShow})),c=0;c<n.length;c++)if(n[c]._children){n[c].name&&(n[c].name=t(n[c].name));for(var r=0;r<n[c]._children.length;r++)n[c]._children[r].name?n[c]._children[r].name=t(n[c]._children[r].name):n[c]._children[r]=t(n[c]._children[r])}else n[c].name=t(n[c].name);return Object(i.jsxs)(o.H,{show:s,onShowChange:function(e){return a({type:"set",sidebarShow:e})},children:[Object(i.jsxs)(o.I,{className:"d-md-down-none",to:"/",children:[Object(i.jsx)(h.a,{className:"c-sidebar-brand-full",name:"logo-negative",height:35}),Object(i.jsx)(h.a,{className:"c-sidebar-brand-minimized",name:"sygnet",height:35})]}),Object(i.jsx)(o.K,{children:Object(i.jsx)(o.m,{items:n,components:{CSidebarNavDivider:o.L,CSidebarNavDropdown:o.M,CSidebarNavItem:o.N,CSidebarNavTitle:o.O}})}),Object(i.jsx)(o.J,{className:"c-d-md-down-none"})]})},L=Object(H.b)()(s.a.memo(q)),P=t(748),z=[{_tag:"CSidebarNavItem",name:"Dashboard",to:"/dashboard",icon:Object(i.jsx)(h.a,{name:"cil-speedometer",customClasses:"c-sidebar-nav-icon"}),badge:{color:"info",text:"NEW"}},{_tag:"CSidebarNavTitle",_children:["Host services"],permission:[j.d.HOST]},{_tag:"CSidebarNavItem",name:"Host's Cars",icon:"cil-car-alt",permission:[j.d.HOST],to:"/cars"},{_tag:"CSidebarNavItem",name:"Host's Drivers",icon:"cil-user",permission:[j.d.HOST],to:"/drivers"},{_tag:"CSidebarNavItem",name:"Host's Working Provinces",icon:"cil-location-pin",permission:[j.d.HOST],to:"/host-details"},{_tag:"CSidebarNavTitle",_children:["Airport services"]},{_tag:"CSidebarNavDropdown",name:"Requests",icon:"cil-airplane-mode",permission:[j.d.AGENCY,j.d.HOST],_children:[{_tag:"CSidebarNavItem",name:"List Requests",to:"/requests",permission:[j.d.AGENCY,j.d.HOST]},{_tag:"CSidebarNavItem",name:"Create Request",to:"/requests/create",permission:[j.d.AGENCY]}]},{_tag:"CSidebarNavDropdown",name:"Contracts",icon:"cil-car-alt",permission:[j.d.AGENCY,j.d.HOST],_children:[{_tag:"CSidebarNavItem",name:"List Contracts",to:"/contracts",permission:[j.d.AGENCY,j.d.HOST]}]},{_tag:"CSidebarNavDropdown",name:"Transactions",icon:"cil-cash",permission:[j.d.ADMIN],_children:[{_tag:"CSidebarNavItem",name:"List Requests' Transaction",to:"/transactions/requests",permission:[j.d.ADMIN]},{_tag:"CSidebarNavItem",name:"List Drivers' Transaction",to:"/transactions/drivers",permission:[j.d.ADMIN]}]}],Y=t(868),R=t(872);n.default=function(e){var n=Object(p.c)((function(e){return e.user})),t=[],s=[];return Object(a.useEffect)((function(){console.log("Run socket"),Y.a.getInstance(n.data._id,n.data.role).on("notification",(function(e){console.log(e)}))}),[]),!n||R.isEmpty(n.data)?Object(i.jsx)(r.a,{to:"/login"}):(t=Object(P.b)(k,n.data.role),s=Object(P.a)(z,n.data.role),Object(i.jsxs)("div",{className:"c-app c-default-layout",children:[Object(i.jsx)(L,{navigation:s}),Object(i.jsxs)("div",{className:"c-wrapper",children:[Object(i.jsx)(A,{}),Object(i.jsx)("div",{className:"c-body",children:Object(i.jsx)(u,{routes:t})}),Object(i.jsx)(b,{})]})]}))}},748:function(e,n,t){"use strict";t.d(n,"b",(function(){return c})),t.d(n,"a",(function(){return r})),t.d(n,"d",(function(){return o})),t.d(n,"c",(function(){return i}));var a=t(22),s=Object(a.b)();function c(e,n){var t=[];return e.forEach((function(e){e.permission?e.permission.includes(n)&&t.push(e):t.push(e)})),t}function r(e,n){var t=[];return e.forEach((function(e){e.permission?e.permission.includes(n)&&(e._children&&e._children.forEach((function(t,a){t.permission&&!t.permission.includes(n)&&e._children.splice(a,1)})),t.push(e)):(e._children&&e._children.forEach((function(t,a){t.permission&&!t.permission.includes(n)&&e._children.splice(a,1)})),t.push(e))})),t}function o(e){var n={avatar:e.avatar,language:e.language,username:e.username,role:e.role,email:e.email,phone:e.phone,_id:e._id};localStorage.setItem("".concat("ddsb","_user"),JSON.stringify(n))}function i(e){s.post("".concat("http://localhost:8080","/api/users/token"),{refresh_token:localStorage.getItem("".concat("ddsb","_refresh_token"))}).then((function(n){localStorage.setItem("".concat("ddsb","_access_token"),n.data.access_token),e()})).catch((function(e){e.response&&(401!==e.response.status&&403!==e.response.status||(localStorage.removeItem("".concat("ddsb","_user")),localStorage.removeItem("".concat("ddsb","_access_token")),localStorage.removeItem("".concat("ddsb","_refresh_token")),window.location.href="/login"))}))}},860:function(e,n,t){"use strict";t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return u})),t.d(n,"c",(function(){return m}));var a=t(83),s=t.n(a),c=t(132),r=t(22),o=t(78),i=t.n(o),l=t(748);function d(e){return function(){var n=Object(c.a)(s.a.mark((function n(t,a){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.post("".concat("http://localhost:8080","/api/users/login"),e).then((function(e){localStorage.setItem("".concat("ddsb","_access_token"),e.data.access_token),localStorage.setItem("".concat("ddsb","_refresh_token"),e.data.refresh_token),t({type:r.a.LOGIN_SUCCESS,payload:{user:e.data,message:""}})})).catch((function(e){e.response&&t({type:r.a.LOGIN_FAIL,payload:{message:e.response.data.message}})}));case 2:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}function u(e,n){return function(){var t=Object(c.a)(s.a.mark((function t(a,c){var o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=Object(r.b)(),t.next=3,o.get("".concat("http://localhost:8080","/api/language?lang=").concat(e)).then((function(e){a({type:r.a.CHANGE_LANGUAGE_SUCCESS,payload:{language:e.data.language,message:""}})})).catch((function(t){t.response&&(403===t.response.status?Object(l.c)(u(e,n)):a({type:r.a.CHANGE_LANGUAGE_FAIL,payload:{message:t.response.data.message}}))}));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}function m(e){return function(){var e=Object(c.a)(s.a.mark((function e(n,t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(r.b)(),e.next=3,a.post("/users/logout").then((function(e){localStorage.removeItem("".concat("ddsb","_user")),localStorage.removeItem("".concat("ddsb","_access_token")),localStorage.removeItem("".concat("ddsb","_refresh_token")),n({type:r.a.LOGOUT_SUCCESS})})).catch((function(e){e.response&&n({type:r.a.LOGOUT_FAIL})}));case 3:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()}t(189).config()},868:function(e,n,t){"use strict";var a=t(980),s=function(){var e;return{init:function(n,t){return e=new a.io("http://localhost:8080",{query:{_id:n,role:t}})},getInstance:function(n,t){return e||this.init(n,t),e},clearInstance:function(){e=null}}}();n.a=s}}]);
//# sourceMappingURL=23.a0ae03df.chunk.js.map